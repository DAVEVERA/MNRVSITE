<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MNRV Webshop</title>
  <link rel="icon" type="image/png" sizes="32x32" href="img/icons/favicon-32x32.png" />
  <link rel="stylesheet" href="css/style.css">
  <style>
    .modern-webshop-window { width: 100%; max-width: 1200px; height: 100%; max-height: 85vh; }
    .shop-filter-bar-modern {
      display: flex; gap: 12px; margin-bottom: 32px; flex-wrap: wrap; background: rgba(0,0,0,0.3); padding: 16px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); align-items: center;
    }
    .filter-btn-modern { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #a1a1aa; padding: 8px 16px; border-radius: 8px; cursor: pointer; transition: all 0.2s; font-family: 'Inter', sans-serif; font-size: 13px; }
    .filter-btn-modern.active, .filter-btn-modern:hover { background: rgba(139, 92, 246, 0.2); border-color: #8b5cf6; color: #fff; }
    .shop-search-modern {
      display: flex; gap: 8px; margin-left: auto;
    }
    .shop-search-modern input { background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 8px; color: #fff; outline: none; }
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; }
    .product-card { background: linear-gradient(145deg, rgba(20,20,30,0.8), rgba(10,10,15,0.8)); border: 1px solid rgba(255,255,255,0.05); border-radius: 16px; padding: 24px; position: relative; transition: all 0.3s; display: flex; flex-direction: column; overflow: hidden; }
    .product-card:hover { transform: translateY(-4px); border-color: rgba(139, 92, 246, 0.4); box-shadow: 0 10px 30px rgba(139, 92, 246, 0.15); }
    .product-img { height: 120px; display: flex; justify-content: center; align-items: center; background: rgba(0,0,0,0.3); border-radius: 12px; margin-bottom: 20px; position: relative; }
    .product-badge { position: absolute; top: 12px; right: 12px; background: rgba(139,92,246,0.3); border: 1px solid #8b5cf6; color: #fff; padding: 4px 8px; font-size: 10px; border-radius: 4px; font-weight: bold; }
    .product-tags { display: flex; gap: 8px; margin-bottom: 12px; }
    .product-tag { font-size: 10px; background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 12px; color: #a1a1aa; }
    .product-name { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 8px; }
    .product-description { font-size: 13px; color: #a1a1aa; line-height: 1.5; margin-bottom: 24px; flex-grow: 1; }
    .product-price { font-size: 16px; font-weight: 600; color: #60a5fa; margin-bottom: 16px; }
    .product-actions { display: flex; gap: 12px; }
    .product-actions button, .product-actions a { flex: 1; text-align: center; padding: 10px; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; color: #fff; text-decoration: none;}
    .btn-secondary { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); }
    .btn-secondary:hover { background: rgba(255,255,255,0.1); }
    .btn-primary { background: linear-gradient(135deg, #8b5cf6, #3b82f6); box-shadow: 0 4px 12px rgba(139,92,246,0.3); }
    .btn-primary:hover { filter: brightness(1.1); }
    .modern-cart-btn { background: transparent; border: 1px solid rgba(255,255,255,0.2); color: #fff; padding: 8px 16px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.2s; }
    .modern-cart-btn:hover { background: rgba(255,255,255,0.1); }
    .cart-badge { background: #ef4444; color: #fff; font-size: 11px; padding: 2px 6px; border-radius: 12px; }
    .cart-badge.empty { display: none; }
    .hide { display: none !important; }
    
    /* Toast modern */
    .shop-toast {
      position: fixed; bottom: 80px; right: 20px; background: rgba(20,20,30,0.95); border: 1px solid rgba(139,92,246,0.4); 
      color: #fff; padding: 16px 24px; border-radius: 12px; display: flex; align-items: center; gap: 12px; 
      transform: translateY(100px); opacity: 0; transition: all 0.3s; z-index: 10000; box-shadow: 0 10px 25px rgba(0,0,0,0.5);
    }
    .shop-toast.visible { transform: translateY(0); opacity: 1; }

    /* Modals modern */
    .modern-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index: 9999; display: none; }
    .modern-modal-overlay.visible { display: block; }
    .modern-dialog { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); opacity: 0; pointer-events: none; z-index: 10000; transition: all 0.2s; width: 90%; max-width: 600px; }
    .modern-dialog.visible { transform: translate(-50%, -50%) scale(1); opacity: 1; pointer-events: auto; }
    .cart-item { display: flex; align-items: center; gap: 12px; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .cart-item-name { flex: 1; font-weight: 600; font-size: 14px; }
    .cart-item-qty { display: flex; align-items: center; gap: 8px; }
    .qty-btn { background: rgba(255,255,255,0.1); border: none; color: #fff; width: 28px; height: 28px; border-radius: 4px; cursor: pointer; }
    .cart-item-remove { background: rgba(239,68,68,0.2); color: #ef4444; border: none; width: 32px; height: 32px; border-radius: 4px; cursor: pointer; }

    /* Enforce Win95 Flat styling locally */
    .shop-filter-bar-modern, .filter-btn-modern, .shop-search-modern input, 
    .product-card, .product-img, .product-badge, .product-tag, .product-actions button, 
    .product-actions a, .modern-cart-btn, .shop-toast, .qty-btn, .cart-item-remove, .btn-secondary, .btn-primary {
      border-radius: 0 !important;
    }
    .product-card {
      background: #ffffff !important;
      border: 1px solid #000 !important;
      box-shadow: 2px 2px 0 0 #000 !important;
      color: #000 !important;
    }
    .product-card:hover {
      transform: none !important;
      border-color: #008080 !important;
      box-shadow: 2px 2px 0 0 #008080 !important;
    }
    .product-name, .product-price {
      color: #000 !important;
    }
    .product-description, .filter-btn-modern {
      color: #333 !important;
    }
    .shop-filter-bar-modern, .product-img {
      background: #f0f0f0 !important;
      border: 1px solid #000 !important;
    }
    .filter-btn-modern {
      background: #c0c0c0 !important;
      border: 1px outset #fff !important;
      color: #000 !important;
    }
    .filter-btn-modern.active {
      background: #008080 !important;
      color: #fff !important;
      border: 1px inset #000 !important;
    }
    .product-actions button, .product-actions a, .modern-cart-btn {
      background: #c0c0c0 !important;
      border: 1px outset #fff !important;
      color: #000 !important;
    }
    .product-actions button:hover, .product-actions a:hover, .modern-cart-btn:hover {
      background: #c0c0c0 !important;
      filter: none !important;
    }
    .product-actions button:active, .product-actions a:active, .modern-cart-btn:active, .qty-btn:active, .cart-item-remove:active {
      border: 1px inset #000 !important;
    }
    .shop-search-modern input {
      background: #fff !important;
      border: 1px inset #000 !important;
      color: #000 !important;
    }

  </style>
</head>
<body class="modern-page modern-standalone-body">

  <div class="modern-standalone-container">
    <div class="win-window focused modern-webshop-window">
      
      <!-- Title Bar -->
      <div class="win-titlebar">
        <img src="assets/icons/w98_MSIE1_32x32_4.png" class="win-titlebar-icon" alt="Shop Icon">
        <div class="win-titlebar-title">MNRV Webshop</div>
        <div class="win-titlebar-buttons" style="display: flex; align-items: center; gap: 6px;">
          <button class="modern-cart-btn" id="cart-toolbar-btn" style="padding:2px 6px; font-size:10px; height:14px; margin-right:8px; border-radius:0; border:1px solid #000; color:#000; background:#c0c0c0;">
            Winkelwagen <span class="cart-badge empty" id="cart-badge">0</span>
          </button>
          <button class="win-titlebar-btn min-btn" title="Minimaliseren">
            <span style="height: 2px; width: 6px; background: black; margin-top: 8px; margin-right: 2px;"></span>
          </button>
          <button class="win-titlebar-btn max-btn" title="Maximaliseren">
            <span style="height: 8px; width: 9px; border-left: black 1px solid; border-right: black 1px solid; border-bottom: black 1px solid; border-top: black 2px solid;"></span>
          </button>
          <a href="index.html" class="win-titlebar-btn close-btn" style="text-decoration:none; color:black;">×</a>
        </div>
      </div>

      <!-- Content -->
      <div class="modern-body">
        
        <header style="text-align: center; margin-bottom: 40px;">
          <h1 class="modern-h1">De MNRV <span class="modern-gradient-text">Webshop</span></h1>
          <p class="modern-p">Implementeer cutting-edge AI direct in jouw e-commerce architectuur.</p>
        </header>

        <div class="shop-filter-bar-modern">
          <button class="filter-btn filter-btn-modern active" data-filter="all">Alles</button>
          <button class="filter-btn filter-btn-modern" data-filter="ai-agent">AI Agents</button>
          <button class="filter-btn filter-btn-modern" data-filter="webshop">Webshop</button>
          <button class="filter-btn filter-btn-modern" data-filter="ux-ui">UX/UI</button>
          <button class="filter-btn filter-btn-modern" data-filter="strategie">Strategie</button>
          
          <div class="shop-search-modern">
            <input type="text" id="shop-search" placeholder="Zoeken in shop...">
            <button id="shop-search-btn" class="filter-btn-modern" style="padding:8px 12px; border:1px outset #fff;">Zoek</button>
          </div>
        </div>

        <div class="product-grid" id="product-grid">
          
          <!-- Product 1: AI Chatbot Starter -->
          <div class="product-card" data-product-id="chatbot-starter" data-category="ai-agent" data-price="499" data-billing="mnd">
            <div class="product-img">
              <span class="product-badge">Populair</span>
              <div style="font-size: 24px; font-weight: bold;">[ AI CHAT ]</div>
            </div>
            <div class="product-tags"><span class="product-tag">AI</span><span class="product-tag">Chatbot</span></div>
            <div class="product-name">AI Chatbot Starter</div>
            <p class="product-description">Basis AI chatbot voor klantenservice op jouw webshop. 24/7 paraat.</p>
            <div class="product-price">Vanaf &euro;499 / mnd</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('chatbot-starter')">Details</button>
              <button class="btn-primary" onclick="addToCart('chatbot-starter')">+ Wagen</button>
            </div>
          </div>

          <!-- Product 2: Product Adviseur Pro -->
          <div class="product-card" data-product-id="product-adviseur" data-category="ai-agent" data-price="899" data-billing="mnd">
            <div class="product-img"><div style="font-size: 24px; font-weight: bold;">[ ADVISEUR ]</div></div>
            <div class="product-tags"><span class="product-tag">AI</span><span class="product-tag">Sales</span></div>
            <div class="product-name">Product Adviseur Pro</div>
            <p class="product-description">AI-gedreven productaanbevelingen op basis van klantgedrag.</p>
            <div class="product-price">Vanaf &euro;899 / mnd</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('product-adviseur')">Details</button>
              <button class="btn-primary" onclick="addToCart('product-adviseur')">+ Wagen</button>
            </div>
          </div>

          <!-- Product 3: UX Optimizer -->
          <div class="product-card" data-product-id="ux-optimizer" data-category="ux-ui" data-price="699" data-billing="mnd">
            <div class="product-img"><div style="font-size: 24px; font-weight: bold;">[ OPTIMIZER ]</div></div>
            <div class="product-tags"><span class="product-tag">UX/UI</span><span class="product-tag">A/B Testing</span></div>
            <div class="product-name">UX Optimizer</div>
            <p class="product-description">AI A/B testing en personalisatie voor hogere conversie.</p>
            <div class="product-price">Vanaf &euro;699 / mnd</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('ux-optimizer')">Details</button>
              <button class="btn-primary" onclick="addToCart('ux-optimizer')">+ Wagen</button>
            </div>
          </div>

          <!-- Product 4: MNRV Enterprise -->
          <div class="product-card" data-product-id="enterprise" data-category="webshop" data-price="0" data-billing="custom">
            <div class="product-img">
              <span class="product-badge" style="background:#b91c1c; border-color:#ef4444;">Premium</span>
              <div style="font-size: 24px; font-weight: bold;">[ ENTERPRISE ]</div>
            </div>
            <div class="product-tags"><span class="product-tag">Enterprise</span><span class="product-tag">Custom</span></div>
            <div class="product-name">MNRV Enterprise</div>
            <p class="product-description">Complete AI-suite: agents, optimalisatie, custom integraties.</p>
            <div class="product-price">Op aanvraag</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('enterprise')">Details</button>
              <a href="contact.html" class="btn-primary">Offerte</a>
            </div>
          </div>

          <!-- Product 5: AI Workshop -->
          <div class="product-card" data-product-id="workshop" data-category="strategie" data-price="1250" data-billing="eenmalig">
            <div class="product-img"><div style="font-size: 24px; font-weight: bold;">[ WORKSHOP ]</div></div>
            <div class="product-tags"><span class="product-tag">Training</span><span class="product-tag">Team</span></div>
            <div class="product-name">AI Workshop</div>
            <p class="product-description">Halve dag AI-workshop op locatie voor jouw team.</p>
            <div class="product-price">&euro;1.250 eenmalig</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('workshop')">Details</button>
              <button class="btn-primary" onclick="addToCart('workshop')">+ Wagen</button>
            </div>
          </div>

          <!-- Product 6: AI Strategie Traject -->
          <div class="product-card" data-product-id="strategie-traject" data-category="strategie" data-price="2500" data-billing="eenmalig">
            <div class="product-img"><div style="font-size: 24px; font-weight: bold;">[ STRATEGIE ]</div></div>
            <div class="product-tags"><span class="product-tag">Strategie</span><span class="product-tag">Roadmap</span></div>
            <div class="product-name">AI Strategie Traject</div>
            <p class="product-description">Complete AI roadmap op maat voor jouw organisatie.</p>
            <div class="product-price">Vanaf &euro;2.500</div>
            <div class="product-actions">
              <button class="btn-secondary" onclick="openProductModal('strategie-traject')">Details</button>
              <button class="btn-primary" onclick="addToCart('strategie-traject')">+ Wagen</button>
            </div>
          </div>

        </div>

        <div class="no-results hide" id="no-results" style="text-align: center; padding: 40px;">
          <div style="font-size: 24px; font-weight: bold; margin-bottom: 16px;">[ GEEN RESULTATEN ]</div>
          <p class="modern-p">We konden geen producten vinden voor deze categorie/zoekopdracht.</p>
          <button class="btn-secondary" style="padding: 10px 20px; border-radius: 8px; color: #fff; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05);" onclick="resetFilters()">Reset Filters</button>
        </div>

      </div>
    </div>
  </div>

  <!-- Product Modal -->
  <div class="modern-modal-overlay" id="modal-overlay"></div>
  <div id="product-modal" class="win-window modern-dialog" style="height: auto; max-height: 80vh;">
    <div class="win-titlebar">
      <div class="win-titlebar-title" id="modal-title">Product Details</div>
      <div class="win-titlebar-buttons">
        <button class="win-titlebar-btn close-btn" onclick="closeProductModal()">×</button>
      </div>
    </div>
    <div class="modern-body" id="modal-body" style="padding: 24px;">
      <!-- Dyn content -->
    </div>
  </div>

  <!-- Cart Window -->
  <div id="cart-window" class="win-window modern-dialog" style="height: auto; max-height: 80vh;">
    <div class="win-titlebar">
      <div class="win-titlebar-title">Jouw Winkelwagen</div>
      <div class="win-titlebar-buttons">
        <button class="win-titlebar-btn close-btn" onclick="toggleCart()">×</button>
      </div>
    </div>
    <div class="modern-body" style="padding: 24px;">
      <div id="cart-body"></div>
      <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center;">
        <span style="font-size: 16px; font-weight: bold;">Totaal: <span id="cart-total" style="color: #60a5fa">&euro;0</span></span>
        <button id="checkout-btn" class="btn-primary" style="padding: 12px 24px; border-radius: 8px; border:none; color:#fff; cursor:pointer;" onclick="startCheckout()">Afrekenen</button>
      </div>
    </div>
  </div>

  <!-- Checkout Dialog -->
  <div class="win-window modern-dialog" id="checkout-dialog" style="height: auto; max-height: 80vh;">
    <div class="win-titlebar">
      <div class="win-titlebar-title">Bestelling verwerken...</div>
      <div class="win-titlebar-buttons">
        <button class="win-titlebar-btn close-btn" onclick="closeCheckout()">×</button>
      </div>
    </div>
    <div class="modern-body" id="checkout-body" style="padding: 24px; text-align: center;">
      <!-- Dyn content -->
    </div>
  </div>

  <div class="shop-toast" id="shop-toast">
    <div style="font-size: 16px; font-weight: bold;">[ OK ]</div>
    <span id="toast-text" style="font-weight: 500;">Item toegevoegd</span>
  </div>

  <!-- Taskbar Override -->
  <div class="taskbar modern-taskbar-override">
    <a href="index.html" class="start-btn clean-link">
      <span class="start-logo-grid">
        <span class="bg-red-500"></span><span class="bg-green-500"></span><span class="bg-blue-500"></span><span class="bg-yellow-500"></span>
      </span>
      <span>Start</span>
    </a>
    <div class="taskbar-windows flex-1">
      <button class="taskbar-window-btn modern-sys-active">Webshop</button>
    </div>
    <div class="system-tray">
      <span id="tray-clock" class="tray-clock">00:00</span>
    </div>
  </div>

<script>
(function() {
  'use strict';

  // ============================================
  // PRODUCT DATA
  // ============================================
  var products = {
    'chatbot-starter': {
      id: 'chatbot-starter',
      name: 'AI Chatbot Starter',
      price: 499,
      billing: '/mnd',
      billingLabel: 'per maand',
      category: 'ai-agent',
      type: 'Maandelijks abonnement',
      description: 'Een krachtige AI-chatbot die direct geïntegreerd wordt in jouw webshop. De chatbot beantwoordt klantvragen 24/7, begeleidt bezoekers naar de juiste producten en verlaagt de druk op je klantenservice team.',
      features: [
        'Automatische klantenservice 24/7',
        'Integratie met Magento, Shopify & WooCommerce',
        'Meertalige ondersteuning (NL/EN/DE/FR)',
        'Zelflerend systeem op basis van jouw productdata',
        'Dashboard met klantinzichten en analytics',
        'Tot 5.000 gesprekken per maand',
        'E-mail escalatie naar support team'
      ]
    },
    'product-adviseur': {
      id: 'product-adviseur',
      name: 'Product Adviseur Pro',
      price: 899,
      billing: '/mnd',
      billingLabel: 'per maand',
      category: 'ai-agent',
      type: 'Maandelijks abonnement',
      description: 'Een AI-adviseur die klantgedrag analyseert en real-time gepersonaliseerde productaanbevelingen doet. Verhoog je gemiddelde orderwaarde en conversieratio met slimme cross-sell en upsell suggesties.',
      features: [
        'Real-time productaanbevelingen',
        'Analyse van browse- en koopgedrag',
        'Cross-sell en upsell optimalisatie',
        'Gepersonaliseerde product bundles',
        'A/B testing van aanbevelingsstrategieën',
        'Integratie met bestaande productcatalogus',
        'Gemiddeld +23% orderwaarde verhoging',
        'Uitgebreid analytics dashboard'
      ]
    },
    'ux-optimizer': {
      id: 'ux-optimizer',
      name: 'UX Optimizer',
      price: 699,
      billing: '/mnd',
      billingLabel: 'per maand',
      category: 'ux-ui',
      type: 'Maandelijks abonnement',
      description: 'AI-gedreven UX optimalisatie die automatisch varianten test en de beste layout, content en call-to-actions selecteert. Maximaliseer conversie zonder handmatig A/B tests op te zetten.',
      features: [
        'Automatische A/B en multivariate testing',
        'AI-gestuurde layout optimalisatie',
        'Heatmap en clickstream analyse',
        'Personalisatie per bezoekerssegment',
        'Conversie-funnel analyse en optimalisatie',
        'Mobile UX optimalisatie',
        'Maandelijks optimalisatierapport'
      ]
    },
    'enterprise': {
      id: 'enterprise',
      name: 'MNRV Enterprise',
      price: 0,
      billing: '',
      billingLabel: 'op aanvraag',
      category: 'webshop',
      type: 'Maatwerk pakket',
      description: 'De complete MNRV AI-suite voor enterprise klanten. Bevat alle individuele producten plus custom integraties, dedicated support en een persoonlijke AI-strategie adviseur. Volledig afgestemd op jouw specifieke situatie.',
      features: [
        'Alle MNRV producten inbegrepen',
        'Dedicated account manager',
        'Custom AI-model training op jouw data',
        'On-premise of private cloud deployment',
        'SLA met 99.9% uptime garantie',
        'Priority support met 1-uur responstijd',
        'Kwartaal strategie review sessies',
        'Custom API integraties',
        'GDPR en compliance ondersteuning'
      ]
    },
    'workshop': {
      id: 'workshop',
      name: 'AI Workshop',
      price: 1250,
      billing: '',
      billingLabel: 'eenmalig',
      category: 'strategie',
      type: 'Eenmalige investering',
      description: 'Een interactieve halve dag workshop voor jouw team. Ontdek hoe AI jouw e-commerce processen kan verbeteren, ga hands-on aan de slag met AI tools en ontwikkel een eerste actieplan.',
      features: [
        'Halve dag (4 uur) on-site of remote',
        'AI landschap overzicht voor e-commerce',
        'Hands-on sessie met AI tools',
        'Use-case identificatie voor jouw business',
        'Quick-win actieplan',
        'Geschikt voor teams van 5-15 personen',
        'Inclusief presentatiemateriaal',
        'Follow-up call na 2 weken'
      ]
    },
    'strategie-traject': {
      id: 'strategie-traject',
      name: 'AI Strategie Traject',
      price: 2500,
      billing: '',
      billingLabel: 'eenmalig (vanaf)',
      category: 'strategie',
      type: 'Eenmalige investering',
      description: 'Een volledig AI strategietraject op maat. We analyseren je huidige processen, identificeren AI-kansen en ontwikkelen een concrete roadmap met business cases, tijdlijn en ROI berekeningen.',
      features: [
        'Uitgebreide analyse van huidige processen',
        'AI-readiness assessment',
        'Identificatie van AI use cases',
        'Business case per use case met ROI',
        'Implementatie roadmap (12-18 maanden)',
        'Technologie stack advies',
        'Vendor selectie ondersteuning',
        'Eindpresentatie aan stakeholders',
        'Optioneel: begeleiding bij implementatie'
      ]
    }
  };

  // ============================================
  // CART STATE
  // ============================================
  var cart = [];

  function loadCart() {
    try {
      var saved = sessionStorage.getItem('mnrv-cart');
      if (saved) cart = JSON.parse(saved);
    } catch(e) { cart = []; }
  }

  function saveCart() {
    try {
      sessionStorage.setItem('mnrv-cart', JSON.stringify(cart));
    } catch(e) {}
  }

  // ============================================
  // CLOCK
  // ============================================
  function updateClock() {
    var el = document.getElementById('tray-clock');
    if (!el) return;
    var now = new Date();
    el.textContent = String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0');
  }

  // ============================================
  // CATEGORY FILTERING
  // ============================================
  var activeFilter = 'all';
  var activeSearch = '';

  function initFilters() {
    var filterBtns = document.querySelectorAll('.filter-btn');
    filterBtns.forEach(function(btn) {
      btn.addEventListener('click', function() {
        filterBtns.forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        activeFilter = btn.getAttribute('data-filter');
        applyFilters();
      });
    });

    var searchInput = document.getElementById('shop-search');
    var searchBtn = document.getElementById('shop-search-btn');
    if (searchInput) {
      searchInput.addEventListener('input', function() {
        activeSearch = searchInput.value.toLowerCase().trim();
        applyFilters();
      });
      searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') applyFilters();
      });
    }
    if (searchBtn) {
      searchBtn.addEventListener('click', function() {
        activeSearch = (document.getElementById('shop-search').value || '').toLowerCase().trim();
        applyFilters();
      });
    }
  }

  function applyFilters() {
    var cards = document.querySelectorAll('.product-card');
    var visibleCount = 0;
    cards.forEach(function(card) {
      var cat = card.getAttribute('data-category');
      var name = (card.querySelector('.product-name') || {}).textContent || '';
      var desc = (card.querySelector('.product-description') || {}).textContent || '';
      var tags = card.querySelectorAll('.product-tag');
      var tagText = '';
      tags.forEach(function(t) { tagText += ' ' + t.textContent; });
      var searchText = (name + ' ' + desc + ' ' + tagText).toLowerCase();

      var catMatch = (activeFilter === 'all' || cat === activeFilter);
      var searchMatch = (!activeSearch || searchText.indexOf(activeSearch) !== -1);

      if (catMatch && searchMatch) {
        card.classList.remove('hide');
        visibleCount++;
      } else {
        card.classList.add('hide');
      }
    });

    var noResults = document.getElementById('no-results');
    if (noResults) {
      if (visibleCount === 0) {
        noResults.classList.remove('hide');
      } else {
        noResults.classList.add('hide');
      }
    }
    updateStatus(visibleCount);
  }

  window.resetFilters = function() {
    activeFilter = 'all';
    activeSearch = '';
    var searchInput = document.getElementById('shop-search');
    if (searchInput) searchInput.value = '';
    document.querySelectorAll('.filter-btn').forEach(function(b) {
      b.classList.toggle('active', b.getAttribute('data-filter') === 'all');
    });
    applyFilters();
  };

  // ============================================
  // ADD TO CART
  // ============================================
  window.addToCart = function(productId) {
    var product = products[productId];
    if (!product) return;
    if (product.price === 0) {
      window.location.href = 'contact.html';
      return;
    }

    var existing = null;
    for (var i = 0; i < cart.length; i++) {
      if (cart[i].id === productId) { existing = cart[i]; break; }
    }

    if (existing) {
      existing.qty++;
    } else {
      cart.push({ id: productId, qty: 1 });
    }

    saveCart();
    updateCartBadge();
    updateStatus();
    showToast(product.name + ' toegevoegd aan wagen');

    // Flash animation on card
    var card = document.querySelector('[data-product-id="' + productId + '"]');
    if (card) {
      card.classList.remove('just-added');
      void card.offsetWidth; // trigger reflow
      card.classList.add('just-added');
    }

    renderCart();
  };

  function addToCartFromModal(productId, qty) {
    var product = products[productId];
    if (!product || product.price === 0) return;

    var existing = null;
    for (var i = 0; i < cart.length; i++) {
      if (cart[i].id === productId) { existing = cart[i]; break; }
    }

    if (existing) {
      existing.qty += qty;
    } else {
      cart.push({ id: productId, qty: qty });
    }

    saveCart();
    updateCartBadge();
    updateStatus();
    closeProductModal();
    showToast(qty + 'x ' + product.name + ' toegevoegd');

    var card = document.querySelector('[data-product-id="' + productId + '"]');
    if (card) {
      card.classList.remove('just-added');
      void card.offsetWidth;
      card.classList.add('just-added');
    }

    renderCart();
    if (!document.getElementById('cart-window').classList.contains('visible')) {
      toggleCart();
    }
  }

  window.removeFromCart = function(productId) {
    cart = cart.filter(function(item) { return item.id !== productId; });
    saveCart();
    updateCartBadge();
    updateStatus();
    renderCart();
  };

  window.changeCartQty = function(productId, delta) {
    for (var i = 0; i < cart.length; i++) {
      if (cart[i].id === productId) {
        cart[i].qty += delta;
        if (cart[i].qty <= 0) {
          cart.splice(i, 1);
        }
        break;
      }
    }
    saveCart();
    updateCartBadge();
    updateStatus();
    renderCart();
  };

  window.clearCart = function() {
    cart = [];
    saveCart();
    updateCartBadge();
    updateStatus();
    renderCart();
  };

  // ============================================
  // CART UI
  // ============================================
  function updateCartBadge() {
    var badge = document.getElementById('cart-badge');
    if (!badge) return;
    var total = 0;
    cart.forEach(function(item) { total += item.qty; });
    badge.textContent = total;
    badge.classList.toggle('empty', total === 0);
  }

  function getCartTotal() {
    var total = 0;
    cart.forEach(function(item) {
      var p = products[item.id];
      if (p) total += p.price * item.qty;
    });
    return total;
  }

  function renderCart() {
    var body = document.getElementById('cart-body');
    var totalEl = document.getElementById('cart-total');
    var checkoutBtn = document.getElementById('checkout-btn');
    if (!body) return;

    if (cart.length === 0) {
      body.innerHTML = '<div class="cart-empty text-center p-20">' +
        '<svg viewBox="0 0 32 32" class="w-32 h-32 mx-auto mb-8">' +
        '<path d="M2 2 L6 2 L10 22 L26 22 L30 8 L8 8" fill="none" stroke="#c0c0c0" stroke-width="2" stroke-linejoin="round"/>' +
        '<circle cx="12" cy="26" r="2" fill="#c0c0c0"/>' +
        '<circle cx="24" cy="26" r="2" fill="#c0c0c0"/>' +
        '</svg>' +
        '<p>Je winkelwagen is leeg.</p>' +
        '<p>Voeg producten toe om te beginnen.</p>' +
        '</div>';
      if (totalEl) totalEl.textContent = '\u20AC0';
      if (checkoutBtn) checkoutBtn.disabled = true;
      return;
    }

    if (checkoutBtn) checkoutBtn.disabled = false;

    var html = '';
    cart.forEach(function(item) {
      var p = products[item.id];
      if (!p) return;
      var lineTotal = p.price * item.qty;
      html += '<div class="cart-item">' +
        '<div class="cart-item-name">' + p.name + '</div>' +
        '<div class="cart-item-qty">' +
        '<button class="qty-btn" onclick="changeCartQty(\'' + item.id + '\', -1)">&minus;</button>' +
        '<span class="qty-val">' + item.qty + '</span>' +
        '<button class="qty-btn" onclick="changeCartQty(\'' + item.id + '\', 1)">+</button>' +
        '</div>' +
        '<div class="cart-item-price">\u20AC' + lineTotal.toLocaleString('nl-NL') + p.billing + '</div>' +
        '<button class="cart-item-remove" onclick="removeFromCart(\'' + item.id + '\')" title="Verwijderen">X</button>' +
        '</div>';
    });

    body.innerHTML = html;
    if (totalEl) totalEl.textContent = '\u20AC' + getCartTotal().toLocaleString('nl-NL');
  }

  window.toggleCart = function() {
    var cartWin = document.getElementById('cart-window');
    if (!cartWin) return;
    cartWin.classList.toggle('visible');
    renderCart();
  };

  // ============================================
  // PRODUCT MODAL
  // ============================================
  var modalQty = 1;

  window.openProductModal = function(productId) {
    var product = products[productId];
    if (!product) return;
    modalQty = 1;

    document.getElementById('modal-title').textContent = product.name + ' - Productinformatie';

    var priceText = product.price > 0
      ? '\u20AC' + product.price.toLocaleString('nl-NL') + ' ' + product.billingLabel
      : 'Op aanvraag';

    var featuresHtml = '';
    product.features.forEach(function(f) {
      featuresHtml += '<li>' + f + '</li>';
    });

    var addBtnHtml = product.price > 0
      ? '<div class="modal-quantity">' +
        '<label>Aantal:</label>' +
        '<button class="qty-btn" onclick="modalChangeQty(-1)">&minus;</button>' +
        '<input type="text" class="qty-display" id="modal-qty-display" value="1" readonly title="Aantal items">' +
        '<button class="qty-btn" onclick="modalChangeQty(1)">+</button>' +
        '</div>' +
        '<div class="modal-buttons d-flex gap-8 justify-end mt-16 max-w-full">' +
        '<button class="btn-secondary" style="padding: 10px 20px; border-radius: 8px; color: #fff; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);" onclick="closeProductModal()">Sluiten</button>' +
        '<button class="btn-primary" style="padding: 10px 20px; border-radius: 8px; color: #fff; border: none; cursor: pointer;" onclick="modalAddToCart(\'' + productId + '\')">Toevoegen aan wagen</button>' +
        '</div>'
      : '<div class="modal-buttons d-flex gap-8 justify-end mt-16 max-w-full">' +
        '<button class="btn-secondary" style="padding: 10px 20px; border-radius: 8px; color: #fff; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);" onclick="closeProductModal()">Sluiten</button>' +
        '<a href="contact.html" class="btn-primary" style="padding: 10px 20px; border-radius: 8px; color: #fff; display: inline-block; text-decoration: none;">Offerte aanvragen</a>' +
        '</div>';

    document.getElementById('modal-body').innerHTML =
      '<div class="modal-header">' +
      '<div class="modal-icon">' + getProductIcon(productId) + '</div>' +
      '<div class="modal-info">' +
      '<h2>' + product.name + '</h2>' +
      '<div class="modal-type">' + product.type + '</div>' +
      '<div class="modal-price">' + priceText + '</div>' +
      '</div>' +
      '</div>' +
      '<div class="modal-description">' + product.description + '</div>' +
      '<div class="modal-features">' +
      '<h3>Kenmerken:</h3>' +
      '<ul>' + featuresHtml + '</ul>' +
      '</div>' +
      addBtnHtml;

    document.getElementById('product-modal').classList.add('visible');
    document.getElementById('modal-overlay').classList.add('visible');
  };

  window.closeProductModal = function() {
    document.getElementById('product-modal').classList.remove('visible');
    document.getElementById('modal-overlay').classList.remove('visible');
  };

  window.modalChangeQty = function(delta) {
    modalQty = Math.max(1, modalQty + delta);
    var display = document.getElementById('modal-qty-display');
    if (display) display.value = modalQty;
  };

  window.modalAddToCart = function(productId) {
    addToCartFromModal(productId, modalQty);
  };

  function getProductIcon(productId) {
    var card = document.querySelector('[data-product-id="' + productId + '"] .product-img svg');
    return card ? card.outerHTML : '';
  }

  // Close modal on overlay click
  document.getElementById('modal-overlay').addEventListener('click', function() {
    closeProductModal();
  });

  // ============================================
  // CHECKOUT
  // ============================================
  window.startCheckout = function() {
    if (cart.length === 0) return;

    var cartWin = document.getElementById('cart-window');
    if (cartWin) cartWin.classList.remove('visible');

    var dialog = document.getElementById('checkout-dialog');
    var body = document.getElementById('checkout-body');

    var itemsHtml = '';
    cart.forEach(function(item) {
      var p = products[item.id];
      if (!p) return;
      itemsHtml += '<div class="d-flex justify-between fs-11 py-2">' +
        '<span>' + item.qty + 'x ' + p.name + '</span>' +
        '<span>\u20AC' + (p.price * item.qty).toLocaleString('nl-NL') + '</span>' +
        '</div>';
    });

    body.innerHTML =
      '<div class="mb-12">' +
      '<p class="fs-11 fw-bold mb-6">Bestelling overzicht:</p>' +
      '<div class="bg-white p-6 border-2 border-shadow-highlight-highlight-shadow">' +
      itemsHtml +
      '<div class="border-t-gray mt-4 pt-4 d-flex justify-between fs-12 fw-bold">' +
      '<span>Totaal:</span>' +
      '<span class="text-green-800">\u20AC' + getCartTotal().toLocaleString('nl-NL') + '</span>' +
      '</div></div></div>' +
      '<p class="fs-11">Bestelling wordt verwerkt...</p>' +
      '<div class="checkout-progress"><div class="checkout-progress-bar" id="checkout-progress-bar"></div></div>' +
      '<div class="checkout-status" id="checkout-status">Verbinding maken met server...</div>';

    dialog.classList.add('visible');

    // Simulate checkout progress
    var steps = [
      { pct: 20, text: 'Verbinding maken met MNRV server...', delay: 800 },
      { pct: 40, text: 'Producten valideren...', delay: 1200 },
      { pct: 60, text: 'Beschikbaarheid controleren...', delay: 1000 },
      { pct: 80, text: 'Bestelling aanmaken...', delay: 1500 },
      { pct: 100, text: 'Bestelling bevestigd!', delay: 1000 }
    ];

    var bar = document.getElementById('checkout-progress-bar');
    var status = document.getElementById('checkout-status');
    var currentStep = 0;

    function nextStep() {
      if (currentStep >= steps.length) {
        showCheckoutSuccess();
        return;
      }
      var step = steps[currentStep];
      bar.style.width = step.pct + '%';
      status.textContent = step.text;
      currentStep++;
      setTimeout(nextStep, step.delay);
    }

    setTimeout(nextStep, 500);
  };

  function showCheckoutSuccess() {
    var body = document.getElementById('checkout-body');
    var titleEl = document.getElementById('checkout-dialog').querySelector('.win-titlebar-title');
    if (titleEl) titleEl.textContent = 'Bestelling succesvol!';

    body.innerHTML =
      '<div class="checkout-success">' +
      '<svg viewBox="0 0 48 48" class="w-48 h-48">' +
      '<circle cx="24" cy="24" r="20" fill="#008000"/>' +
      '<path d="M14 24 L21 31 L34 18" fill="none" stroke="#fff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>' +
      '</svg>' +
      '<p class="fs-13 fw-bold text-green-800 mb-8">Bestelling succesvol ontvangen!</p>' +
      '<p>Bedankt voor je interesse in MNRV. Ons team neemt binnen 24 uur contact met je op om de details te bespreken.</p>' +
      '<p class="mt-8 fs-10 text-gray-800">Referentienummer: MNRV-' + Date.now().toString(36).toUpperCase() + '</p>' +
      '<div class="mt-12 d-flex gap-6 justify-center">' +
      '<button class="btn-secondary" style="padding: 10px 20px; border-radius: 8px; color: #fff; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);" onclick="closeCheckout()">Verder winkelen</button>' +
      '<a href="contact.html" class="btn-primary" style="padding: 10px 20px; border-radius: 8px; color: #fff; display: inline-block; text-decoration: none;">Contact opnemen</a>' +
      '</div>' +
      '</div>';

    // Clear cart after successful checkout
    cart = [];
    saveCart();
    updateCartBadge();
    updateStatus();
    renderCart();
  }

  window.closeCheckout = function() {
    var dialog = document.getElementById('checkout-dialog');
    if (dialog) dialog.classList.remove('visible');
    var titleEl = dialog.querySelector('.win-titlebar-title');
    if (titleEl) titleEl.textContent = 'Fout bij verwerken...';
  };

  // ============================================
  // TOAST NOTIFICATION
  // ============================================
  var toastTimer = null;
  function showToast(message) {
    var toast = document.getElementById('shop-toast');
    var text = document.getElementById('toast-text');
    if (!toast || !text) return;
    text.textContent = message;
    toast.classList.add('visible');
    if (toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(function() {
      toast.classList.remove('visible');
    }, 2500);
  }

  // ============================================
  // STATUS BAR
  // ============================================
  function updateStatus(visibleCount) {
    var el = document.getElementById('shop-status');
    if (!el) return;
    var total = 0;
    cart.forEach(function(item) { total += item.qty; });
    var productCount = typeof visibleCount === 'number' ? visibleCount : document.querySelectorAll('.product-card:not([style*="display: none"])').length;
    el.textContent = productCount + ' producten | Wagen: ' + total + ' item' + (total !== 1 ? 's' : '');
  }

  // ============================================
  // INIT
  // ============================================
  updateClock();
  setInterval(updateClock, 10000);
  loadCart();
  initFilters();
  updateCartBadge();
  updateStatus();
  renderCart();

  // Cart toggle button
  document.getElementById('cart-toolbar-btn').addEventListener('click', function() {
    toggleCart();
  });

})();
</script>

</body>
</html>
